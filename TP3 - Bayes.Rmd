---
title: |
  \vspace{1cm}
  \begin{tabular}{c}
  {\normalsize\textbf{UNIVERSIDAD NACIONAL DE ROSARIO}}\\
  {\Large Facultad de Ciencias Económicas y Estadística}\\
  \\
  \\
  \includegraphics[width=5cm]{LogoUNR.png}\\
  \\
  \\
  {\huge\textbf{Análisis de temperatura corporal postmortem}}\\
  {\huge\textbf{utilizando modelos lineales bayesianos}}\\
  \\
  {\Large Estadística Bayesiana - Trabajo Práctico Nº3}\\
  \end{tabular}
  \vspace{4cm}
author: |
  Alumnas: Agustina Mac Kay, Ailén Salas y Rocío Canteros
date: "Año 2024"
output: pdf_document
editor_options: 
  markdown: 
    wrap: sentence
  chunk_output_type: console
---

```{r setup, echo=FALSE}
knitr::opts_chunk$set(echo = FALSE, fig.height = 3)
```
# Introducción

La tanatocronología, derivada de las palabras griegas "thanatos" (muerte) y "chronos" (tiempo), es un subcampo de la medicina forense que se centra en determinar el intervalo postmortem, es decir, el tiempo transcurrido desde la muerte hasta el descubrimiento del cadáver.[^1]

[^1]: Fuente: [\textcolor{blue}{\underline{Diccionario Médico: tanatocronología - Clínica Universidad de Navarra}}](https://www.cun.es/diccionario-medico/terminos/tanatocronologia#:~:text=La%20tanatocronolog%C3%ADa%2C%20derivada%20de%20las,hasta%20el%20descubrimiento%20del%20cad%C3%A1ver.)

Desde el momento de la muerte, comienza en el cuerpo humano una serie de procesos químicos y físicos que se conocen como fenómenos cadavéricos. Uno de ellos es el enfriamiento del cuerpo (enfriamiento postmortem o *algor mortis*). En este proceso, la temperatura del cadáver desciende hasta igualarse con la temperatura ambiente. Este descenso ocurre más rápido en las primeras horas después de la muerte.

El objetivo de este trabajo es averiguar la hora de muerte de Sergio Contreras, un hombre que fue hallado muerto sobre un charco de sangre en su casa en la localidad cordobesa de Salsipuedes. Para resolver este acertijo, se cuenta con la siguiente información sobre la temperatura corporal del cuerpo del hombre:

* Dato relevante 1
* Dato relevante 2
* Dato relevante 3
* ...

# Sección con nombre ????

Como el ritmo con el cual el cuerpo pierde temperatura no es constante, se puede pensar que la derivada de la temperatura respecto al tiempo varía con el tiempo. En este caso, la temperatura del cadáver satisface la siguiente ley: 

$$ \frac{dT(t)}{dt} = r[T_{\text{amb}}-T(t)] \tag{1} $$
donde \(T_{\text{amb}}\) es la temperatura ambiente (un valor fijo y conocido), \(r\) es una constante y \(T(t)\) es la función (por ahora desconocida) que describe la temperatura del cuerpo en función del tiempo.

Una posible función \(T(t)\) es: 

$$ T(t)=T_{\text{amb}} + (T_i - T_{\text{amb}})* e^{-rt} $$
siendo \(T_i\) la temperatura a la que está inicialmente el cuerpo. 

La misma satisface la ecuación \((1)\) ya que:

$$ \frac{dT(t)}{dt} = (T_i - T_{\text{amb}}).  (-r).  e^{-rt} = $$
$$ = -r . [(T_i - T_{amb}) . e^{-rt}] = $$
$$ = -r . [-T_{amb}+T_{amb}+(T_i - T_{amb}) . e^{-rt}] = $$
$$ = -r . [-T_{amb}+T(t)] = $$
 $$ = r.[T(t) - T_{amb}] $$
```{r}
library(ggplot2)
library(dplyr)

# Gráfico de tiempo
t_amb <- 23
t_i <- 37
t <- seq(1, 40, by = 1)
r <- c(0.1, 0.12, 0.15, 0.2, 0.3)

funcion_t <- function(t_amb, t_i, t, r) {
  t_amb + (t_i- t_amb) * exp(-r*t)
}

funcion_t_vector <- Vectorize(funcion_t)

df_T <- data.frame(
  t_amb = t_amb,
  t_i = t_i,
  t = rep(seq(t), times = length(r)),
  r = rep(r, each = length(t))
)

df_T <- df_T %>% 
  mutate(func_t = funcion_t_vector(df_T$t_amb, df_T$t_i, df_T$t, df_T$r))

ggplot(df_T) +
  geom_line(aes(x = t, y = func_t, color = factor(r)), linewidth = 1.2) +
  scale_x_continuous(breaks = seq(0, 40, by = 5), name = "Hora (t)") +
  scale_y_continuous(breaks = seq(23, 37, by = 2), name = "T(t)") +
  scale_color_manual(values = c("orchid3", "palegreen3", 'hotpink', 'gold3', 'firebrick3'), name = "r") +
  geom_hline(yintercept = 23, linetype = "dashed") +
  labs(caption = "Figura 1: Gráfica de la función de descenso de la temperatura corporal T(t) para 2 valores de la constante r,\n con una temperatura inicial del cuerpo de 37 Cº hasta alcanzar una temperatura ambiente de 23 Cº") +
  theme_bw() +
  theme(plot.caption = element_text(hjust = 0.5))
```
*r* es una constante que representa la conductividad entre el cuerpo y la superficie de contacto, por lo que un conjunto de valores razonables sería entre 0.05 y 0.2 .

Los órganos abdominales pueden mantener el calor por al menos 24 horas. En las primeras 12 horas se va perdiendo el calor de 0.8 a 1.0 grado centígrado por hora y en las siguientes 12 horas de 0.3 a 0.5 grados centígrados
# Poner fuente

Demostración de logaritmo
$$ ln(T(t) - T_{amb}) = ln( T_{diff} . e^{-rt}) = ln(T_{diff}) + (-rt) = $$
$$ = ln(T_{diff}) - rt = \beta_{0} + \beta_{1}t $$
donde $$ \beta_{0} $$ sería el logaritmo de la diferencia entre ... y $$ \beta_{1} $$ es cuanto va cambiando el logaritmo de la temperatura corporal menos la temperatura del ambiente por cada hora que transcurre Por este motivo es la constante de conductividad
